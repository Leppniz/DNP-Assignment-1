@page "/AddChild"
@attribute [Authorize(Policy = "MustBeAdmin")]
@using Models
@using FileData

<AuthorizeView>
 <NotAuthorized>
  <h3>You need to log in to edit data!</h3>
 </NotAuthorized>
 <Authorized>
<h1>Add child:</h1>
<br>
<label for="fname">First name:</label><br>
<input type="text" @bind="fname" id="fname" name="fname"><br><br>
<label for="lname">Last name:</label><br>
<input type="text" @bind="@lname" id="lname" name="lname"><br><br>
<label for="haircolor">Hair Color:</label><br>
<input type="text" @bind="haircolor" id="haircolor" name="haircolor"><br><br>
<label for="eyecolor">Eye Color:</label><br>
<input type="text" @bind="eyecolor" id="eyecolor" name="eyecolor"><br><br>
<label for="age">Age:</label><br>
<input type="text" @bind="age" id="age" name="age"><br><br>
<label for="weight">Weight:</label><br>
<input type="text" @bind="weight" id="weight" name="weight"><br><br>
<label for="height">Height:</label><br>
<input type="text" @bind="height" id="height" name="height"><br><br>
<label for="sex">Sex:</label><br>
<input type="text" @bind="sex" id="sex" name="sex"><br><br>
<h3 for="interestd">Add Interest (Optional):</h3><br>
<label for="interest">Interest:</label><br>
<input type="text" @bind="interest" id="interest" name="interest"><br><br>
<label for="interestd">Interest Description:</label><br>
<input type="text" @bind="interestd" id="interestd" name="interestd"><br><br>
<h3 for="interestd">Add Pet (Optional):</h3><br>
<label for="interestd">Species:</label><br>
<input type="text" @bind="species" id="interestd" name="interestd"><br><br>
<label for="interestd">Pet Name:</label><br>
<input type="text" @bind="petname" id="interestd" name="interestd"><br><br>
<label for="interestd">Pet Age:</label><br>
<input type="text" @bind="petage" id="interestd" name="interestd"><br><br>
<label id="fields" for="fields">Remember! Required fields cannot be empty!</label><br>
<input type="submit" @onclick="addNewChild" value="Save"><br><br>
 </Authorized>
</AuthorizeView> 
@code {
 string fname;
 string lname;
 string haircolor;
 string eyecolor;
 int age;
 int weight;
 int height;
 string sex;
 string interest;
 string interestd;
 string species;
 string petname;
 int petage;


 private void addNewChild()
 {
  if (fname != null && lname != null && haircolor != null && eyecolor != null && sex != null && interest != null && interestd != null)
  {
   Child child = new Child()
   {
    FirstName = fname,
    LastName = lname,
    Age = age,
    EyeColor = eyecolor,
    HairColor = haircolor,
    Height = height,
    Id = age + height + weight,
    Sex = sex,
    Weight = weight,
   };
   if (interest != null && interestd != null)
   {
    Interest interestOfChild = new Interest()
    {
     Description = this.interestd,
     Type = this.interest
    };
    child.Interests.Add(interestOfChild);
   }
   if (species != null && petname != null)
   {
    Random randomx = new Random();
    int random = randomx.Next(214241);
    Pet pet = new Pet()
    {

     Age = petage,
     Id = petage + random,
     Name = petname,
     Species = species
    };
    child.Pets.Add(pet);
   }
   FileContext fileContext = new FileContext();
   fileContext.Children.Add(child);
   fileContext.SaveChanges();

  }
  else
  {
   ;
  }
  

 }

}